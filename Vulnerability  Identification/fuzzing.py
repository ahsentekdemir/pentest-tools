import httpx
import sys
from bs4 import BeautifulSoup, SoupStrainer

url = "http://127.0.0.1/xss/guestbook.php"
url2 = "http://127.0.0.1/xss/addguestbook.php"
url3 = "http://127.0.0.1/xss/viewguestbook.php"

f = open("fuzzdb-payloads.txt")
o = open("results.txt")

init = httpx.get(url)

for payload in f.readlines():
    for _ in BeautifulSoup(init.text, parse_only=SoupStrainer('input')):
        d = {}
        if _.has_attrr('name'):
            if _['name'].lower == 'submit':
                d[_['name']] == 'submit'
            else:
                d[_['name']] == payload
    
    req = httpx.post(url2, data=d)
    res = httpx.get(url3)

    o.write("payload: " + payload + "\n")
    o.write(res.text + "\n")
    
