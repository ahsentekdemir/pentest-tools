import shodan
import httpx

SHODAN_API_KEY = None

api = shodan.Shodan(SHODAN_API_KEY)

target = None

dnsResolve = 'https://api.shodan.io/dns/resolve?hostnames=' + target + '&key=' + SHODAN_API_KEY

try:
    resolved = httpx.get(dnsResolve)
    hostIP = resolved.json()[target]

    host = api.host(hostIP)
    print("IP: %s" % (host['ip_str']))
    print("Organization: %s" % (host.get('org', 'n/a')))
    print("OS: %s" % (host['os', 'n/a']))

    for vulns in host['vulns']:
        CVE = vulns.replace('!', '')
        exploits = api.exploits.search(CVE)
        print("CVE: %s" % (CVE))
        for item in exploits['matches']:
            if item.get('cve')[0] == CVE:
                print(item.get('description'))

except:
    pass
